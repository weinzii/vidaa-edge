<div class="flex flex-col h-full">
  <div
    *ngIf="!selectedFile"
    class="flex-1 flex flex-col items-center justify-center text-gray-500"
  >
    <div class="text-6xl mb-4">üìÑ</div>
    <p class="text-sm">Select a file to view details</p>
  </div>

  <!-- LIST VIEW MODE (Metadata first) -->
  <div
    *ngIf="selectedFile && viewMode === 'list'"
    class="flex-1 min-h-0 flex flex-col"
  >
    <div
      class="flex-shrink-0 flex items-center justify-between px-4 py-2 bg-purple-900 border-b border-purple-700"
    >
      <h3 class="text-sm font-semibold text-purple-200 break-all flex-1">
        {{ selectedFile.path }}
      </h3>
      <button
        class="ml-2 px-2 py-1 text-xs bg-customGray hover:bg-gray-700 text-gray-200 rounded transition-colors flex-shrink-0"
        (click)="copyToClipboard(selectedFile.path)"
        title="Copy path"
      >
        üìã
      </button>
    </div>

    <div class="flex-1 min-h-0 overflow-y-auto p-4 space-y-4">
      <!-- Discovery Chain (NEW) -->
      <div
        *ngIf="getDiscoveryChain(selectedFile).length > 1"
        class="p-3 bg-purple-900/20 border border-purple-700 rounded space-y-2"
      >
        <p class="text-xs font-semibold text-purple-300">üîç Discovery Chain:</p>

        <!-- Breadcrumb -->
        <div class="flex items-center gap-2 flex-wrap text-sm">
          <ng-container
            *ngFor="
              let item of getDiscoveryChain(selectedFile);
              let last = last
            "
          >
            <button
              *ngIf="item.path"
              class="px-2 py-1 rounded bg-purple-800 hover:bg-purple-700 text-purple-200 transition-colors text-xs font-medium"
              (click)="selectFile(item.path)"
              [title]="item.path"
              type="button"
            >
              {{ item.icon }} {{ item.name }}
            </button>
            <span *ngIf="!last" class="text-purple-500 text-lg">‚Üí</span>
          </ng-container>
        </div>

        <!-- Method Details -->
        <div class="text-xs text-gray-400 space-y-1 mt-2">
          <div
            *ngFor="let item of getDiscoveryChain(selectedFile); let i = index"
          >
            <span *ngIf="i > 0" class="text-purple-400 font-semibold"
              >Level {{ i }}:</span
            >
            <span [class.ml-2]="i > 0" [class.font-semibold]="i === 0">{{
              item.description
            }}</span>
          </div>
        </div>
      </div>

      <!-- Discovered From (Source File) - Keep for single-level reference -->
      <div
        *ngIf="
          selectedFile.discoveredFrom &&
          getDiscoveryChain(selectedFile).length === 1
        "
        class="p-3 bg-purple-900/20 border border-purple-700 rounded space-y-1"
      >
        <p class="text-xs font-semibold text-purple-300">üìç Discovered From:</p>
        <button
          class="text-sm text-orange-400 hover:text-orange-300 underline cursor-pointer break-all text-left"
          (click)="selectFile(selectedFile.discoveredFrom)"
          title="Click to view source file"
          type="button"
        >
          {{ selectedFile.discoveredFrom }}
        </button>
      </div>

      <!-- File Metadata -->
      <div class="space-y-2">
        <div class="flex items-center gap-2 text-sm">
          <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
            >Status:</span
          >
          <span
            class="px-2 py-0.5 rounded text-xs font-medium"
            [ngClass]="{
              'bg-green-900 text-green-300': selectedFile.status === 'success',
              'bg-orange-900 text-orange-300':
                selectedFile.status === 'access-denied' ||
                selectedFile.status === 'not-found',
              'bg-red-900 text-red-300': selectedFile.status === 'error'
            }"
            >{{ selectedFile.status }}</span
          >
        </div>
        <div
          class="flex items-center gap-2 text-sm"
          *ngIf="selectedFile.status === 'success'"
        >
          <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
            >Type:</span
          >
          <span class="text-gray-200">{{ selectedFile.fileType }}</span>
        </div>
        <div
          class="flex items-center gap-2 text-sm"
          *ngIf="selectedFile.status === 'success'"
        >
          <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
            >Size:</span
          >
          <span class="text-gray-200">{{ formatSize(selectedFile.size) }}</span>
        </div>
        <div
          class="flex items-center gap-2 text-sm"
          *ngIf="selectedFile.magicBytes"
        >
          <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
            >Magic Bytes:</span
          >
          <span
            class="font-mono text-xs bg-gray-900 border border-gray-700 px-2 py-1 rounded text-gray-200"
            >{{ selectedFile.magicBytes }}</span
          >
        </div>
        <div
          class="flex items-center gap-2 text-sm"
          *ngIf="selectedFile.confidence"
        >
          <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
            >Confidence:</span
          >
          <span class="text-gray-200"
            >{{ (selectedFile.confidence * 100).toFixed(1) }}%</span
          >
        </div>
        <div class="flex items-center gap-2 text-sm" *ngIf="selectedFile.error">
          <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
            >Error:</span
          >
          <span class="text-red-400">{{ selectedFile.error }}</span>
        </div>
      </div>

      <!-- Extracted Paths -->
      <div
        *ngIf="
          selectedFile.extractedPaths.length > 0 ||
          selectedFile.ignoredPaths?.length
        "
        class="space-y-2"
      >
        <h4 class="text-sm font-bold text-purple-200">
          üîó Extracted Paths ({{ selectedFile.extractedPaths.length
          }}<span
            *ngIf="selectedFile.ignoredPaths?.length"
            class="text-gray-400"
            >, {{ selectedFile.ignoredPaths?.length }} ignored</span
          >)
        </h4>

        <!-- New Paths -->
        <div *ngIf="selectedFile.extractedPaths.length > 0" class="space-y-1">
          <div
            *ngFor="let path of selectedFile.extractedPaths"
            class="flex items-center justify-between gap-2 px-2 py-1 bg-customGray border border-green-700 rounded text-xs break-all"
          >
            <span class="text-gray-300">{{ path }}</span>
            <button
              class="px-1.5 py-0.5 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded transition-colors flex-shrink-0"
              (click)="copyToClipboard(path)"
              title="Copy"
            >
              üìã
            </button>
          </div>
        </div>

        <!-- Ignored Paths -->
        <div *ngIf="selectedFile.ignoredPaths?.length" class="space-y-1 mt-2">
          <p class="text-xs text-gray-400 italic">
            ‚ö†Ô∏è Already in queue/scanned:
          </p>
          <div
            *ngFor="let path of selectedFile.ignoredPaths"
            class="flex items-center justify-between gap-2 px-2 py-1 bg-customGray border border-gray-600 rounded text-xs break-all opacity-60"
          >
            <span class="text-gray-400">{{ path }}</span>
            <button
              class="px-1.5 py-0.5 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded transition-colors flex-shrink-0"
              (click)="copyToClipboard(path)"
              title="Copy"
            >
              üìã
            </button>
          </div>
        </div>
      </div>

      <!-- Text Content -->
      <div
        *ngIf="selectedFile.status === 'success' && !selectedFile.isBinary"
        class="space-y-2"
      >
        <div class="flex items-center justify-between">
          <h4 class="text-sm font-bold text-purple-200">üìÑ Full Content</h4>
          <div class="flex gap-2">
            <button
              class="px-2 py-1 text-xs bg-customGray hover:bg-gray-700 text-gray-200 rounded transition-colors"
              (click)="refreshContent()"
              title="Refresh content from TV"
              [disabled]="isLoadingContent"
            >
              üîÑ Refresh
            </button>
            <button
              class="px-2 py-1 text-xs bg-customGray hover:bg-gray-700 text-gray-200 rounded transition-colors"
              (click)="copyToClipboard(selectedFile.content || '')"
              title="Copy full content"
              [disabled]="isLoadingContent"
            >
              üìã Copy All
            </button>
          </div>
        </div>

        <!-- Loading indicator -->
        <div
          *ngIf="isLoadingContent"
          class="bg-gray-900 p-4 rounded text-center text-gray-400 text-sm"
        >
          <div class="animate-pulse">‚è≥ Loading content from TV...</div>
        </div>

        <!-- Content display -->
        <pre
          *ngIf="!isLoadingContent"
          class="bg-gray-900 text-green-400 p-3 rounded text-xs overflow-x-auto font-mono whitespace-pre-wrap break-all"
          >{{
            selectedFile.content ||
              '(Content not available - file was not scanned with content)'
          }}</pre
        >
      </div>

      <!-- Binary Preview -->
      <div
        *ngIf="selectedFile.status === 'success' && selectedFile.isBinary"
        class="p-4 bg-customGray border border-gray-700 rounded space-y-2"
      >
        <p class="text-sm text-gray-300">
          üîí Binary file detected. Type:
          <strong class="text-purple-200">{{ selectedFile.fileType }}</strong>
        </p>
        <p class="text-sm text-gray-300">
          Size: {{ formatSize(selectedFile.size) }}
        </p>
      </div>

      <!-- Debug Info (Collapsible) -->
      <details class="group">
        <summary
          class="cursor-pointer px-3 py-2 bg-gray-800 border border-gray-700 rounded hover:bg-gray-750 transition-colors"
        >
          <div class="flex items-center justify-between">
            <span class="text-sm font-semibold text-gray-300">
              üîç Debug Information
            </span>
            <span
              class="text-xs text-gray-500 group-open:rotate-90 transition-transform"
              >‚ñ∂</span
            >
          </div>
        </summary>

        <div
          class="mt-2 p-3 bg-gray-900 border border-gray-700 rounded space-y-3"
        >
          <!-- Processing Summary -->
          <div class="space-y-1">
            <p class="text-xs font-semibold text-blue-300">
              Processing Summary:
            </p>
            <div class="text-xs text-gray-400 space-y-1 font-mono">
              <div>
                <span class="text-gray-500">Status:</span>
                <span
                  [class]="
                    selectedFile.status === 'success'
                      ? 'text-green-400'
                      : 'text-red-400'
                  "
                  >{{ selectedFile.status }}</span
                >
              </div>
              <div>
                <span class="text-gray-500">Discovery Method:</span>
                <span class="text-purple-400">{{
                  selectedFile.discoveryMethod
                }}</span>
              </div>
              <div *ngIf="selectedFile.discoveredFrom">
                <span class="text-gray-500">Discovered From:</span>
                <span class="text-orange-400">{{
                  selectedFile.discoveredFrom
                }}</span>
              </div>
              <div *ngIf="selectedFile.isBinary !== undefined">
                <span class="text-gray-500">Is Binary:</span>
                <span class="text-blue-400">{{ selectedFile.isBinary }}</span>
              </div>
              <div *ngIf="selectedFile.fileType">
                <span class="text-gray-500">File Type:</span>
                <span class="text-blue-400">{{ selectedFile.fileType }}</span>
              </div>
              <div>
                <span class="text-gray-500">Size:</span>
                <span class="text-blue-400">{{
                  formatSize(selectedFile.size)
                }}</span>
              </div>
              <div *ngIf="selectedFile.confidence">
                <span class="text-gray-500">Confidence:</span>
                <span class="text-blue-400"
                  >{{ (selectedFile.confidence * 100).toFixed(1) }}%</span
                >
              </div>
              <div>
                <span class="text-gray-500">Timestamp:</span>
                <span class="text-blue-400">{{
                  selectedFile.timestamp | date : 'HH:mm:ss.SSS'
                }}</span>
              </div>
            </div>
          </div>

          <!-- Path Extraction Details -->
          <div class="space-y-1" *ngIf="selectedFile.extractedPaths.length > 0">
            <p class="text-xs font-semibold text-green-300">
              Path Extraction ({{ selectedFile.extractedPaths.length }} new):
            </p>
            <div class="text-xs text-gray-400 font-mono space-y-0.5">
              <div *ngFor="let path of selectedFile.extractedPaths">
                ‚úì {{ path }}
              </div>
            </div>
          </div>

          <!-- Ignored Paths -->
          <div class="space-y-1" *ngIf="selectedFile.ignoredPaths?.length">
            <p class="text-xs font-semibold text-yellow-300">
              Ignored Paths ({{ selectedFile.ignoredPaths?.length }} already
              known):
            </p>
            <div class="text-xs text-gray-500 font-mono space-y-0.5">
              <div *ngFor="let path of selectedFile.ignoredPaths">
                ‚äò {{ path }}
              </div>
            </div>
          </div>

          <!-- Variables Discovered -->
          <div class="space-y-1" *ngIf="getVariablesDiscovered().length > 0">
            <p class="text-xs font-semibold text-purple-300">
              Variables Discovered ({{ getVariablesDiscovered().length }}):
            </p>
            <div class="text-xs text-gray-400 font-mono space-y-0.5">
              <div *ngFor="let varInfo of getVariablesDiscovered()">
                <span class="text-purple-400">{{ varInfo.name }}</span> =
                <span class="text-green-400">"{{ varInfo.value }}"</span>
                <span class="text-gray-600">({{ varInfo.confidence }})</span>
              </div>
            </div>
          </div>

          <!-- Templates Deferred -->
          <div class="space-y-1" *ngIf="getTemplatesDeferred().length > 0">
            <p class="text-xs font-semibold text-orange-300">
              Templates Deferred ({{ getTemplatesDeferred().length }}):
            </p>
            <div class="text-xs text-gray-400 font-mono space-y-0.5">
              <div *ngFor="let template of getTemplatesDeferred()">
                ‚è≥ {{ template.template }}
                <span class="text-gray-600"
                  >(waiting for: {{ template.variables.join(', ') }})</span
                >
              </div>
            </div>
          </div>

          <!-- Error Details -->
          <div class="space-y-1" *ngIf="selectedFile.error">
            <p class="text-xs font-semibold text-red-300">Error Details:</p>
            <pre
              class="text-xs text-red-400 font-mono whitespace-pre-wrap break-all p-2 bg-red-900/20 border border-red-800 rounded"
              >{{ selectedFile.error }}</pre
            >
          </div>

          <!-- Copy All Debug Info -->
          <div class="pt-2 border-t border-gray-700">
            <button
              class="w-full px-3 py-2 text-xs bg-gray-800 hover:bg-gray-700 text-gray-200 rounded transition-colors font-medium"
              (click)="copyDebugInfo()"
              title="Copy all debug information to clipboard"
              type="button"
            >
              üìã Copy Debug Info to Clipboard
            </button>
          </div>
        </div>
      </details>
    </div>
  </div>

  <!-- TREE VIEW MODE (Content first with tabs) -->
  <div
    *ngIf="selectedFile && viewMode === 'tree'"
    class="flex-1 min-h-0 flex flex-col"
  >
    <div
      class="flex-shrink-0 flex items-center justify-between px-4 py-2 bg-purple-900 border-b border-purple-700"
    >
      <h3 class="text-sm font-semibold text-purple-200 break-all flex-1">
        {{ selectedFile.path }}
      </h3>
      <button
        class="ml-2 px-2 py-1 text-xs bg-customGray hover:bg-gray-700 text-gray-200 rounded transition-colors flex-shrink-0"
        (click)="copyToClipboard(selectedFile.path)"
        title="Copy path"
      >
        üìã
      </button>
    </div>

    <!-- Tabs -->
    <div
      class="flex-shrink-0 bg-customGray-light border-b border-gray-700 px-4"
    >
      <div class="flex gap-2">
        <button
          (click)="activeTab = 'content'"
          class="px-4 py-2 text-sm font-medium transition-colors border-b-2"
          [ngClass]="{
            'text-orange-400 border-orange-500': activeTab === 'content',
            'text-gray-400 border-transparent hover:text-gray-200':
              activeTab !== 'content'
          }"
        >
          üìÑ Content
        </button>
        <button
          (click)="activeTab = 'metadata'"
          class="px-4 py-2 text-sm font-medium transition-colors border-b-2"
          [ngClass]="{
            'text-orange-400 border-orange-500': activeTab === 'metadata',
            'text-gray-400 border-transparent hover:text-gray-200':
              activeTab !== 'metadata'
          }"
        >
          ‚ÑπÔ∏è Metadata
        </button>
      </div>
    </div>

    <!-- Tab Content -->
    <div class="flex-1 min-h-0 overflow-y-auto p-4">
      <!-- Content Tab -->
      <div *ngIf="activeTab === 'content'" class="space-y-4">
        <!-- Loading Indicator -->
        <div
          *ngIf="isLoadingContent"
          class="p-4 bg-customGray border border-purple-700 rounded animate-pulse"
        >
          <p class="text-sm text-purple-300">‚è≥ Loading content from TV...</p>
        </div>

        <!-- Text Content -->
        <div
          *ngIf="
            !isLoadingContent &&
            selectedFile.status === 'success' &&
            !selectedFile.isBinary
          "
        >
          <div class="flex items-center justify-between mb-2">
            <h4 class="text-sm font-bold text-purple-200">üìÑ Full Content</h4>
            <button
              class="px-2 py-1 text-xs bg-customGray hover:bg-gray-700 text-gray-200 rounded transition-colors"
              [disabled]="isLoadingContent"
              (click)="copyToClipboard(selectedFile.content || '')"
              title="Copy full content"
            >
              üìã Copy All
            </button>
          </div>
          <pre
            class="bg-gray-900 text-green-400 p-3 rounded text-xs overflow-x-auto font-mono whitespace-pre-wrap break-all"
            >{{
              selectedFile.content ||
                '(Content not available. Click the file again to load it.)'
            }}</pre
          >
        </div>

        <!-- Binary Preview -->
        <div
          *ngIf="
            !isLoadingContent &&
            selectedFile.status === 'success' &&
            selectedFile.isBinary
          "
          class="p-4 bg-customGray border border-gray-700 rounded space-y-2"
        >
          <p class="text-sm text-gray-300">
            üîí Binary file detected. Type:
            <strong class="text-purple-200">{{ selectedFile.fileType }}</strong>
          </p>
          <p class="text-sm text-gray-300">
            Size: {{ formatSize(selectedFile.size) }}
          </p>
        </div>

        <!-- Error Message -->
        <div
          *ngIf="!isLoadingContent && selectedFile.status !== 'success'"
          class="p-4 bg-red-900/20 border border-red-800 rounded"
        >
          <p class="text-sm text-red-300">
            {{ selectedFile.error || 'Failed to read file' }}
          </p>
        </div>
      </div>

      <!-- Metadata Tab -->
      <div *ngIf="activeTab === 'metadata'" class="space-y-4">
        <!-- Discovered From -->
        <div
          *ngIf="selectedFile.discoveredFrom"
          class="p-3 bg-purple-900/20 border border-purple-700 rounded space-y-1"
        >
          <p class="text-xs font-semibold text-purple-300">
            üìç Discovered From:
          </p>
          <button
            class="text-sm text-orange-400 hover:text-orange-300 underline cursor-pointer break-all text-left"
            (click)="selectFile(selectedFile.discoveredFrom)"
            title="Click to view source file"
          >
            {{ selectedFile.discoveredFrom }}
          </button>
        </div>

        <!-- File Metadata -->
        <div class="space-y-2">
          <div class="flex items-center gap-2 text-sm">
            <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
              >Status:</span
            >
            <span
              class="px-2 py-0.5 rounded text-xs font-medium"
              [ngClass]="{
                'bg-green-900 text-green-300':
                  selectedFile.status === 'success',
                'bg-orange-900 text-orange-300':
                  selectedFile.status === 'access-denied' ||
                  selectedFile.status === 'not-found',
                'bg-red-900 text-red-300': selectedFile.status === 'error'
              }"
              >{{ selectedFile.status }}</span
            >
          </div>
          <div
            class="flex items-center gap-2 text-sm"
            *ngIf="selectedFile.status === 'success'"
          >
            <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
              >Type:</span
            >
            <span class="text-gray-200">{{ selectedFile.fileType }}</span>
          </div>
          <div
            class="flex items-center gap-2 text-sm"
            *ngIf="selectedFile.status === 'success'"
          >
            <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
              >Size:</span
            >
            <span class="text-gray-200">{{
              formatSize(selectedFile.size)
            }}</span>
          </div>
          <div
            class="flex items-center gap-2 text-sm"
            *ngIf="selectedFile.magicBytes"
          >
            <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
              >Magic Bytes:</span
            >
            <span
              class="font-mono text-xs bg-gray-900 border border-gray-700 px-2 py-1 rounded text-gray-200"
              >{{ selectedFile.magicBytes }}</span
            >
          </div>
          <div
            class="flex items-center gap-2 text-sm"
            *ngIf="selectedFile.confidence"
          >
            <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
              >Confidence:</span
            >
            <span class="text-gray-200"
              >{{ (selectedFile.confidence * 100).toFixed(1) }}%</span
            >
          </div>
          <div
            class="flex items-center gap-2 text-sm"
            *ngIf="selectedFile.error"
          >
            <span class="font-semibold text-gray-400 w-24 flex-shrink-0"
              >Error:</span
            >
            <span class="text-red-400">{{ selectedFile.error }}</span>
          </div>
        </div>

        <!-- Extracted Paths -->
        <div
          *ngIf="
            selectedFile.extractedPaths.length > 0 ||
            selectedFile.ignoredPaths?.length
          "
          class="space-y-2"
        >
          <h4 class="text-sm font-bold text-purple-200">
            üîó Extracted Paths ({{ selectedFile.extractedPaths.length
            }}<span
              *ngIf="selectedFile.ignoredPaths?.length"
              class="text-gray-400"
              >, {{ selectedFile.ignoredPaths?.length }} ignored</span
            >)
          </h4>
          <div *ngIf="selectedFile.extractedPaths.length > 0" class="space-y-1">
            <div
              *ngFor="let path of selectedFile.extractedPaths"
              class="flex items-center justify-between gap-2 px-2 py-1 bg-customGray border border-green-700 rounded text-xs break-all"
            >
              <span class="text-gray-300">{{ path }}</span>
              <button
                class="px-1.5 py-0.5 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded transition-colors flex-shrink-0"
                (click)="copyToClipboard(path)"
                title="Copy"
              >
                üìã
              </button>
            </div>
          </div>
          <div *ngIf="selectedFile.ignoredPaths?.length" class="space-y-1 mt-2">
            <p class="text-xs text-gray-400 italic">
              ‚ö†Ô∏è Already in queue/scanned:
            </p>
            <div
              *ngFor="let path of selectedFile.ignoredPaths"
              class="flex items-center justify-between gap-2 px-2 py-1 bg-customGray border border-gray-600 rounded text-xs break-all opacity-60"
            >
              <span class="text-gray-400">{{ path }}</span>
              <button
                class="px-1.5 py-0.5 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded transition-colors flex-shrink-0"
                (click)="copyToClipboard(path)"
                title="Copy"
              >
                üìã
              </button>
            </div>
          </div>
        </div>

        <!-- Debug Info (Collapsible) - Same as List View -->
        <details class="group">
          <summary
            class="cursor-pointer px-3 py-2 bg-gray-800 border border-gray-700 rounded hover:bg-gray-750 transition-colors"
          >
            <div class="flex items-center justify-between">
              <span class="text-sm font-semibold text-gray-300">
                üîç Debug Information
              </span>
              <span
                class="text-xs text-gray-500 group-open:rotate-90 transition-transform"
                >‚ñ∂</span
              >
            </div>
          </summary>

          <div
            class="mt-2 p-3 bg-gray-900 border border-gray-700 rounded space-y-3"
          >
            <!-- Processing Summary -->
            <div class="space-y-1">
              <p class="text-xs font-semibold text-blue-300">
                Processing Summary:
              </p>
              <div class="text-xs text-gray-400 space-y-1 font-mono">
                <div>
                  <span class="text-gray-500">Status:</span>
                  <span
                    [class]="
                      selectedFile.status === 'success'
                        ? 'text-green-400'
                        : 'text-red-400'
                    "
                    >{{ selectedFile.status }}</span
                  >
                </div>
                <div>
                  <span class="text-gray-500">Discovery Method:</span>
                  <span class="text-purple-400">{{
                    selectedFile.discoveryMethod
                  }}</span>
                </div>
                <div *ngIf="selectedFile.discoveredFrom">
                  <span class="text-gray-500">Discovered From:</span>
                  <span class="text-orange-400">{{
                    selectedFile.discoveredFrom
                  }}</span>
                </div>
                <div *ngIf="selectedFile.isBinary !== undefined">
                  <span class="text-gray-500">Is Binary:</span>
                  <span class="text-blue-400">{{ selectedFile.isBinary }}</span>
                </div>
                <div *ngIf="selectedFile.fileType">
                  <span class="text-gray-500">File Type:</span>
                  <span class="text-blue-400">{{ selectedFile.fileType }}</span>
                </div>
                <div>
                  <span class="text-gray-500">Size:</span>
                  <span class="text-blue-400">{{
                    formatSize(selectedFile.size)
                  }}</span>
                </div>
                <div *ngIf="selectedFile.confidence">
                  <span class="text-gray-500">Confidence:</span>
                  <span class="text-blue-400"
                    >{{ (selectedFile.confidence * 100).toFixed(1) }}%</span
                  >
                </div>
                <div>
                  <span class="text-gray-500">Timestamp:</span>
                  <span class="text-blue-400">{{
                    selectedFile.timestamp | date : 'HH:mm:ss.SSS'
                  }}</span>
                </div>
              </div>
            </div>

            <!-- Path Extraction Details -->
            <div
              class="space-y-1"
              *ngIf="selectedFile.extractedPaths.length > 0"
            >
              <p class="text-xs font-semibold text-green-300">
                Path Extraction ({{ selectedFile.extractedPaths.length }} new):
              </p>
              <div class="text-xs text-gray-400 font-mono space-y-0.5">
                <div *ngFor="let path of selectedFile.extractedPaths">
                  ‚úì {{ path }}
                </div>
              </div>
            </div>

            <!-- Ignored Paths -->
            <div class="space-y-1" *ngIf="selectedFile.ignoredPaths?.length">
              <p class="text-xs font-semibold text-yellow-300">
                Ignored Paths ({{ selectedFile.ignoredPaths?.length }} already
                known):
              </p>
              <div class="text-xs text-gray-500 font-mono space-y-0.5">
                <div *ngFor="let path of selectedFile.ignoredPaths">
                  ‚äò {{ path }}
                </div>
              </div>
            </div>

            <!-- Error Details -->
            <div class="space-y-1" *ngIf="selectedFile.error">
              <p class="text-xs font-semibold text-red-300">Error Details:</p>
              <pre
                class="text-xs text-red-400 font-mono whitespace-pre-wrap break-all p-2 bg-red-900/20 border border-red-800 rounded"
                >{{ selectedFile.error }}</pre
              >
            </div>

            <!-- Copy All Debug Info -->
            <div class="pt-2 border-t border-gray-700">
              <button
                class="w-full px-3 py-2 text-xs bg-gray-800 hover:bg-gray-700 text-gray-200 rounded transition-colors font-medium"
                (click)="copyDebugInfo()"
                title="Copy all debug information to clipboard"
                type="button"
              >
                üìã Copy Debug Info to Clipboard
              </button>
            </div>
          </div>
        </details>
      </div>
    </div>
  </div>
</div>
